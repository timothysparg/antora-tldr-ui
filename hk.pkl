amends "package://github.com/jdx/hk/releases/download/v1.10.6/hk@1.10.6#/Config.pkl"
import "package://github.com/jdx/hk/releases/download/v1.10.6/hk@1.10.6#/Builtins.pkl"

local linters = new Mapping<String, Step> {
   ["actionlint"] = Builtins.actionlint
   ["biome"] = (Builtins.biome) {
      fix = "biome check --write {{ files }}"
      exclude = List(
         "src/js/vendor/**"
      )
   }
   ["stylelint"] = (Builtins.stylelint) {
      check = "npx -y stylelint --cache --cache-location .stylelintcache {{ files }}"
      fix = "npx -y stylelint --cache --cache-location .stylelintcache --fix {{ files }}"
  }
   ["djlint"] = new Step {
      glob = List("**/*.hbs")
      exclude = List(
         "node_modules/**"
      )
      check = "djlint {{ files }} --profile=handlebars --lint"
      fix = "djlint {{ files }} --profile=handlebars --reformat"
   }
   ["validate"] = new Step {
      glob = List("**/*")
      exclude = List(
         "node_modules/**",
         "build/**",
         "public/**"
      )
      check = "mise run validate"
   }
}

hooks {
  ["pre-commit"] {
    fix = true
    stash = "git"
    steps = linters
  }
  ["check"] {
    steps = linters
  }
  ["fix"] {
    fix = true
    steps = linters
  }
}
